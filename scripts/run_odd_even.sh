#!/usr/bin/bash

NCORES_EVEN=$1
shift
NCORES_ODD=$1
shift

RANK=0
[ $OMPI_COMM_WORLD_RANK ] && RANK=$OMPI_COMM_WORLD_RANK

let MODULUS=${RANK}%2
if [ $MODULUS -eq 0 ]
then
	OMP_NUM_THREADS=${NCORES_EVEN}
else
	OMP_NUM_THREADS=${NCORES_ODD}
fi

echo "OMP_NUM_THREADS=${OMP_NUM_THREADS}"
export OMP_NUM_THREADS

$*

