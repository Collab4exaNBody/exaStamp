species:
  - Cno2: { z: 12, mass:  12.0110 Da, charge:  0.34068 e-, molecule: TATB }
  - Cnh2: { z: 12, mass:  12.0110 Da, charge: -0.24300 e-, molecule: TATB }
  - No2 : { z: 14, mass:  14.0000 Da, charge:  0.67980 e-, molecule: TATB }
  - Nh2 : { z: 14, mass:  14.0000 Da, charge: -0.69300 e-, molecule: TATB }
  - O   : { z: 16, mass:  16.0000 Da, charge: -0.51024 e-, molecule: TATB }
  - H   : { z:  1, mass:   1.0080 Da, charge:  0.46800 e-, molecule: TATB }

# Intramolecular interactions
compute_force_bond:
      virial: false
      potentials_for_bonds:
        &definition_bonds
        - {types: [Cno2, Cnh2], potential: harm_bond, parameters: {r0: 1.440 ang, k: 500.00 Da*kcal/g/ang^2} }
        - {types: [Cno2, No2 ], potential: harm_bond, parameters: {r0: 1.427 ang, k: 300.00 Da*kcal/g/ang^2} }
        - {types: [Cnh2, Nh2 ], potential: harm_bond, parameters: {r0: 1.322 ang, k: 672.00 Da*kcal/g/ang^2} }
        - {types: [No2 , O   ], potential: harm_bond, parameters: {r0: 1.230 ang, k: 878.00 Da*kcal/g/ang^2} }
        - {types: [Nh2 , H   ], potential: harm_bond, parameters: {r0: 1.010 ang, k: 850.00 Da*kcal/g/ang^2} }

compute_force_bend:
      virial: false
      potentials_for_angles:
        &definition_angles      
        - {types: [Cno2, Cnh2, Cno2], potential: harm_bend, parameters: { theta0: 118.4 degree, k:  64 Da*kcal/g} }
        - {types: [Cno2, Cnh2, Nh2 ], potential: harm_bend, parameters: { theta0: 121.7 degree, k:  60 Da*kcal/g} }
        - {types: [Cno2, No2 , O   ], potential: harm_bend, parameters: { theta0: 116.8 degree, k: 140 Da*kcal/g} }
        - {types: [Cnh2, Cno2, Cnh2], potential: harm_bend, parameters: { theta0: 121.6 degree, k:  64 Da*kcal/g} }
        - {types: [Cnh2, Cno2, No2 ], potential: harm_bend, parameters: { theta0: 119.2 degree, k:  60 Da*kcal/g} }
        - {types: [Cnh2, Nh2 , H   ], potential: harm_bend, parameters: { theta0: 112.0 degree, k:  64 Da*kcal/g} }  
        - {types: [O   , No2 , O   ], potential: harm_bend, parameters: { theta0: 117.3 degree, k:  95 Da*kcal/g} }
        - {types: [H   , Nh2 , H   ], potential: harm_bend, parameters: { theta0: 119.0 degree, k:  64 Da*kcal/g} }

compute_force_torsion:
      virial: false
      potentials_for_torsions:
        &definition_torsions      
        - {types: [Cno2, Cnh2, Cno2, Cnh2], potential: opls_torsion, parameters: { k1: 0.00 Da*kcal/g, k2:  5.35 Da*kcal/g, k3: 0.00 Da*kcal/g} }
        - {types: [Cno2, Cnh2, Cno2, No2 ], potential: opls_torsion, parameters: { k1: 0.00 Da*kcal/g, k2: 20.00 Da*kcal/g, k3: 0.00 Da*kcal/g} }
        - {types: [Cno2, Cnh2, Nh2 , H   ], potential: opls_torsion, parameters: { k1: 0.00 Da*kcal/g, k2:  8.88 Da*kcal/g, k3: 0.00 Da*kcal/g} }
        - {types: [Cnh2, Cno2, Cnh2, Nh2 ], potential: opls_torsion, parameters: { k1: 0.00 Da*kcal/g, k2: 20.00 Da*kcal/g, k3: 0.00 Da*kcal/g} }
        - {types: [Cnh2, Cno2, No2 , O   ], potential: opls_torsion, parameters: { k1: 0.00 Da*kcal/g, k2:  1.60 Da*kcal/g, k3: 0.00 Da*kcal/g} }
        - {types: [Nh2 , Cnh2, Cno2, No2 ], potential: opls_torsion, parameters: { k1: 0.00 Da*kcal/g, k2: 20.00 Da*kcal/g, k3: 0.00 Da*kcal/g} }

compute_force_improper:
      virial: false
      potentials_for_impropers:
        &definition_impropers
        - {types: [Cno2, Cnh2, Cnh2, No2], potential: harm_improper1.0, parameters: { chi0: 0 degree, k: 18.25 Da*kcal/g} }
        - {types: [Cnh2, Cno2, Cno2, Nh2], potential: harm_improper1.0, parameters: { chi0: 0 degree, k: 18.25 Da*kcal/g} }
        - {types: [No2 , Cno2, O   , O  ], potential: harm_improper1.0, parameters: { chi0: 0 degree, k: 44.65 Da*kcal/g} }
        - {types: [Nh2 , Cnh2, H   , H  ], potential: harm_improper1.0, parameters: { chi0: 0 degree, k:  1.05 Da*kcal/g} }

compute_intramolecular_forces:
  - compute_force_bond
  - compute_force_bend
  - compute_force_torsion
  - compute_force_improper

exp6rf_multi_force:
  rcut: 12.5 ang
  parameters:
    &intramolecular_pair_potentials
    - { type_a: Cno2, type_b: Cno2, rcut: 12.5 ang, parameters: { rf: { epsilon: 100., rc: 12.5 ang }, exp6_rcut: 11 ang, exp6: { A: 107023.9 Da*kcal/g, B: 3.6405     1/ang, C: 554.01      Da*kcal*ang^6/g, D: 5.0e-5 Da*kcal/g } } }
    - { type_a: Cnh2, type_b: Cnh2, rcut: 12.5 ang, parameters: { rf: { epsilon: 100., rc: 12.5 ang }, exp6_rcut: 11 ang, exp6: { A: 107023.9 Da*kcal/g, B: 3.6405     1/ang, C: 554.01      Da*kcal*ang^6/g, D: 5.0e-5 Da*kcal/g } } }
    - { type_a: No2 , type_b: No2 , rcut: 12.5 ang, parameters: { rf: { epsilon: 100., rc: 12.5 ang }, exp6_rcut: 11 ang, exp6: { A: 13789.9  Da*kcal/g, B: 3.3333     1/ang, C: 423.36      Da*kcal*ang^6/g, D: 5.0e-5 Da*kcal/g } } }
    - { type_a: Nh2 , type_b: Nh2 , rcut: 12.5 ang, parameters: { rf: { epsilon: 100., rc: 12.5 ang }, exp6_rcut: 11 ang, exp6: { A: 39091.8  Da*kcal/g, B: 3.3158     1/ang, C: 833.48      Da*kcal*ang^6/g, D: 5.0e-5 Da*kcal/g } } }
    - { type_a: O   , type_b: O   , rcut: 12.5 ang, parameters: { rf: { epsilon: 100., rc: 12.5 ang }, exp6_rcut: 11 ang, exp6: { A: 15923.1  Da*kcal/g, B: 3.6446     1/ang, C: 239.07      Da*kcal*ang^6/g, D: 5.0e-5 Da*kcal/g } } }
    - { type_a: H   , type_b: H   , rcut: 12.5 ang, parameters: { rf: { epsilon: 100., rc: 12.5 ang }, exp6_rcut: 11 ang, exp6: { A: 7584.2   Da*kcal/g, B: 5.2846     1/ang, C: 8.23        Da*kcal*ang^6/g, D: 5.0e-5 Da*kcal/g } } }
    - { type_a: Cno2, type_b: Cnh2, rcut: 12.5 ang, parameters: { rf: { epsilon: 100., rc: 12.5 ang }, exp6_rcut: 12.5 ang, exp6: { A: 107023.9 Da*kcal/g, B: 3.6405     1/ang, C: 554.01      Da*kcal*ang^6/g, D: 5.0e-5 Da*kcal/g } } }
    - { type_a: Cno2, type_b: No2 , rcut: 12.5 ang, parameters: { rf: { epsilon: 100., rc: 12.5 ang }, exp6_rcut: 12.5 ang, exp6: { A: 37111.29 Da*kcal/g, B: 3.46350030 1/ang, C: 484.2991571 Da*kcal*ang^6/g, D: 5.0e-5 Da*kcal/g } } }
    - { type_a: Cno2, type_b: Nh2 , rcut: 12.5 ang, parameters: { rf: { epsilon: 100., rc: 12.5 ang }, exp6_rcut: 12.5 ang, exp6: { A: 62222.18 Da*kcal/g, B: 3.45198059 1/ang, C: 679.5264931 Da*kcal*ang^6/g, D: 5.0e-5 Da*kcal/g } } }
    - { type_a: Cno2, type_b: O   , rcut: 12.5 ang, parameters: { rf: { epsilon: 100., rc: 12.5 ang }, exp6_rcut: 12.5 ang, exp6: { A: 41281.14 Da*kcal/g, B: 3.64254596 1/ang, C: 363.9329206 Da*kcal*ang^6/g, D: 5.0e-5 Da*kcal/g } } }
    - { type_a: Cno2, type_b: H   , rcut: 12.5 ang, parameters: { rf: { epsilon: 100., rc: 12.5 ang }, exp6_rcut: 12.5 ang, exp6: { A: 16829.52 Da*kcal/g, B: 4.01774768 1/ang, C: 67.52408681 Da*kcal*ang^6/g, D: 5.0e-5 Da*kcal/g } } }
    - { type_a: Cnh2, type_b: No2 , rcut: 12.5 ang, parameters: { rf: { epsilon: 100., rc: 12.5 ang }, exp6_rcut: 12.5 ang, exp6: { A: 37111.29 Da*kcal/g, B: 3.46350030 1/ang, C: 484.2991571 Da*kcal*ang^6/g, D: 5.0e-5 Da*kcal/g } } }
    - { type_a: Cnh2, type_b: Nh2 , rcut: 12.5 ang, parameters: { rf: { epsilon: 100., rc: 12.5 ang }, exp6_rcut: 12.5 ang, exp6: { A: 62222.18 Da*kcal/g, B: 3.45198059 1/ang, C: 679.5264931 Da*kcal*ang^6/g, D: 5.0e-5 Da*kcal/g } } }
    - { type_a: Cnh2, type_b: O   , rcut: 12.5 ang, parameters: { rf: { epsilon: 100., rc: 12.5 ang }, exp6_rcut: 12.5 ang, exp6: { A: 41281.14 Da*kcal/g, B: 3.64254596 1/ang, C: 363.9329206 Da*kcal*ang^6/g, D: 5.0e-5 Da*kcal/g } } }
    - { type_a: Cnh2, type_b: H   , rcut: 12.5 ang, parameters: { rf: { epsilon: 100., rc: 12.5 ang }, exp6_rcut: 12.5 ang, exp6: { A: 16829.52 Da*kcal/g, B: 4.01774768 1/ang, C: 67.52408681 Da*kcal*ang^6/g, D: 5.0e-5 Da*kcal/g } } }
    - { type_a: No2 , type_b: Nh2 , rcut: 12.5 ang, parameters: { rf: { epsilon: 100., rc: 12.5 ang }, exp6_rcut: 12.5 ang, exp6: { A: 23215.03 Da*kcal/g, B: 3.32446940 1/ang, C: 594.0219632 Da*kcal*ang^6/g, D: 5.0e-5 Da*kcal/g } } }
    - { type_a: No2 , type_b: O   , rcut: 12.5 ang, parameters: { rf: { epsilon: 100., rc: 12.5 ang }, exp6_rcut: 12.5 ang, exp6: { A: 14302.04 Da*kcal/g, B: 3.46494293 1/ang, C: 318.1393959 Da*kcal*ang^6/g, D: 5.0e-5 Da*kcal/g } } }
    - { type_a: No2 , type_b: H   , rcut: 12.5 ang, parameters: { rf: { epsilon: 100., rc: 12.5 ang }, exp6_rcut: 12.5 ang, exp6: { A: 4828.685 Da*kcal/g, B: 3.70361219 1/ang, C: 59.02755966 Da*kcal*ang^6/g, D: 5.0e-5 Da*kcal/g } } }
    - { type_a: Nh2 , type_b: O   , rcut: 12.5 ang, parameters: { rf: { epsilon: 100., rc: 12.5 ang }, exp6_rcut: 12.5 ang, exp6: { A: 23978.15 Da*kcal/g, B: 3.45338993 1/ang, C: 446.3855549 Da*kcal*ang^6/g, D: 5.0e-5 Da*kcal/g } } }
    - { type_a: Nh2 , type_b: H   , rcut: 12.5 ang, parameters: { rf: { epsilon: 100., rc: 12.5 ang }, exp6_rcut: 12.5 ang, exp6: { A: 8017.401 Da*kcal/g, B: 3.68530023 1/ang, C: 82.82234240 Da*kcal*ang^6/g, D: 5.0e-5 Da*kcal/g } } }
    - { type_a: O   , type_b: H   , rcut: 12.5 ang, parameters: { rf: { epsilon: 100., rc: 12.5 ang }, exp6_rcut: 12.5 ang, exp6: { A: 6509.200 Da*kcal/g, B: 4.02183407 1/ang, C: 44.35702988 Da*kcal*ang^6/g, D: 5.0e-5 Da*kcal/g } } }

compute_extramolecular_forces:
  - exp6rf_multi_force

intramolecular_pair_weight: molecule_pair_weight

molecule_pair_weight:
  weight: &intramolecular_weighting
    TATB: [-1, 0.0, 0.0]

intramolecular_setup:
  weight: *intramolecular_weighting
  potentials_for_pairs: *intramolecular_pair_potentials
  potentials_for_bonds: *definition_bonds
  potentials_for_angles: *definition_angles
  potentials_for_torsions: *definition_torsions
  potentials_for_impropers: *definition_impropers

